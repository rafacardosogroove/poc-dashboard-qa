name: Gerar Dashboard de Qualidade (BDD)

on:
  push:
    branches:
      - main
    paths:
      - 'features/**/*.feature' # O rob么 s贸 trabalha se algu茅m alterar os BDDs!
  schedule:
    - cron: '0 8 * * 1-5' # Roda sozinho de segunda a sexta s 8h da manh茫
  workflow_dispatch: # Cria um bot茫o no GitHub para voc锚 rodar quando quiser

jobs:
  build-dashboard:
    runs-on: ubuntu-latest
    permissions:
      contents: write # D谩 permiss茫o para o rob么 salvar o arquivo no reposit贸rio

    steps:
      - name:  Checkout do Reposit贸rio
        uses: actions/checkout@v3

      - name:  Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name:  Rodar o Script e Gerar Markdown
        # Executa aquele seu script e salva o texto final neste novo arquivo
        run: python gerar_dashboard.py > README.md

      - name:  Fazer o Commit Autom谩tico
        run: |
          git config --global user.name "Rob么 da Qualidade (QA Bot)"
          git config --global user.email "qa-bot@groovetech.com"
          git add README.md
          
          # Essa linha verifica se os n煤meros mudaram. Se mudaram, ele salva e avisa!
          git diff --quiet && git diff --staged --quiet || (git commit -m "docs:  Atualiza dashboard autom谩tico de cen谩rios BDD" && git push)
